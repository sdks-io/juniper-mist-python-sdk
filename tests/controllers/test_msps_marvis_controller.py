# -*- coding: utf-8 -*-

"""
mistapi

This file was automatically generated by APIMATIC v3.0 (
 https://www.apimatic.io ).
"""

import json
import dateutil.parser

from tests.controllers.controller_test_base import ControllerTestBase
from apimatic_core.utilities.comparison_helper import ComparisonHelper
from mistapi.api_helper import APIHelper


class MspsMarvisControllerTests(ControllerTestBase):

    @classmethod
    def setUpClass(cls):
        super(MspsMarvisControllerTests, cls).setUpClass()
        cls.controller = cls.client.msps_marvis
        cls.response_catcher = cls.controller.http_call_back

    # Count Marvis actions
    #
    def test_count_msps_marvis_actions(self):
        # Parameters for the API call
        msp_id = '000000ab-00ab-00ab-00ab-0000000000ab'
        distinct = 'org_id'
        limit = 100
        page = 1

        # Perform the API call through the SDK function
        result = self.controller.count_msps_marvis_actions(msp_id, distinct, limit, page)

        # Test response code
        assert self.response_catcher.response.status_code == 200

        # Test headers
        expected_headers = {}
        expected_headers['content-type'] = 'application/json'

        assert ComparisonHelper.match_headers(expected_headers, self.response_catcher.response.headers)

        
        # Test whether the captured response is as we expected
        assert result is not None
        expected_body = APIHelper.json_deserialize('{"distinct":"status","limit":1000,"results":[{"count":24,"status":'
            '"002e176a-0000-000-1111-002e208b20e1"},{"count":12,"status":"2d3f1'
            '76a-0000-000-2222-002e208f176a"},{"count":15,"status":"08b2176a-00'
            '00-000-3333-002e208b2d3f"}],"total":3}')
        received_body = APIHelper.json_deserialize(self.response_catcher.response.text)
        assert ComparisonHelper.match_body(expected_body, received_body)

